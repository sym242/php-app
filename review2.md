# PHP App ② レビュー

## XSS(クロスサイトスクリプティング)

### XSSとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- ユーザーのアクセス時に表示内容が生成される動的Webページの脆弱性を利用した攻撃方法のこと。
　
### `htmlspecialchars()`を`e()`として定義しなおすメリットを説明してください。
- 省略することでコードを打つ時間が短くなり、仮にチームでプログラムを作る際にも
　誤解されにくく、判読がしやすいから。

### `htmlspecialchars()`を使うことでなぜXSSが防げるのか説明してください。
- php上で「”、’、＜、＞」がそのままのコードとして処理されず、&quot等に変換されるため
　悪意のあるコードは処理されずにテキストとして処理されるから。

## CSRF(クロスサイトリクエストフォージェリ)

### CSRFとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- 不特定多数の人に対して意図しないリクエスト送信をさせる攻撃。
　CSRFでメールアドレスや住所を特定したり、パスワードを勝手に変更、口座からの不正送金もできてしまうので
　攻撃者の手に届くように商品を購入、送金もできてしまいます。
　
### SessionとCookieの違いを説明してください。
- セッションはサーバーにデータを保存するのに対し、クッキーはブラウザ側に保存するという違いがあります。

### `setToken()`が何をしているか説明してください。
- ランダムな16文字のバイト文字列を生成し、さらにその文字列を16進数(0～9,A,B,C,D,E,F)に変換した値を
　$_SESSION['token']に格納しています。
　
### `checkToken()`が何をしているか説明してください。
- if文でempty関数を使い、$_SESSION['token']に値が存在しない時、または値は存在するけど
　$_SESSION['token']と引数であるcheckToken($token)を比較し、差異がある場合は
　if文はtrueになり、$_SESSION['err']に「不正な操作です」が格納され、
　リダイレクトするための変数redirectToPostedPageが実行されます。

### トークンを使うことでなぜCSRFが防げるのか説明してください。
- サーバへリクエストした際、トークンが作成されそのトークンを埋め込んだページが返されます。
　再度リクエストした際に返されたトークンも送るため、リクエスト元が正しいかチェックし、
　外部のHTMLから送信されることを防げます。

## SQLインジェクション

### SQLインジェクションとはどんな攻撃か、また攻撃者にどんなメリットがあるか説明してください。
- 攻撃側がアプリケーションのセキュリティ上の不備を意図的に利用し、アプリケーションが想定しないSQL文を
　実行させることで、データベースシステムを不正に操作する攻撃方法。
　攻撃者がある企業に対して世間からの信頼を失墜させたいと考えている際、
　情報漏洩やデータベースの改ざんが世間に知られ、その企業の信頼を失わせることができる。

### `->prepare()`の返り値と、またこのメソッドが何をしているか説明してください。
- PDOStatementが返り値となり、todosテーブルのIDが同じかどうか条件で指定し、
　contentにtodoTextが格納されます。

### `->bindValue()`が何をしているか説明してください。
- ユーザーが入力したデータのデータ型を指定し、文字列として認識させ、SQL文を悪意のある攻撃から守っています。

### 今回の対策でなぜSQLインジェクションが防げるのか説明してください。
- プレースホルダーでクッションが挟んであげることによって、文字列として登録することで
　悪意のあるSQLは実行されなくなるから。

## バリデーション

### バリデーションの目的について説明してください。
- ユーザーが入力した情報がその仕様や文法など適切な形式で記述されているかをチェックするため。

### `validate()`が何をしているか説明してください。
- isset($post['content'])で$post['content']内に値が入っているか確認し、
　かつ$post['content']が空白であった場合は、$_SESSION['err']に「入力がありません」を格納、
　リダイレクトするためのredirectToPostedPage変数の実行をしています。

### `isset($post['content'])`はなぜ必要か、無い場合どうなるか説明してください。
- $post['content']内に値が入っているか確認しているためisset($post['content'])の記述が必要になります。
　また記述がないと「$post['content']内が値が入っているかつ、値が空白ではない」という条件から
　外れるため、空白で登録できてしまいます。

## その他

### `unsetError()`を実行しないとどうなるか説明してください。
- unseterrorがないとリロードしても永遠にエラーが出続けてしまうから
　一度リセットする必要があります。